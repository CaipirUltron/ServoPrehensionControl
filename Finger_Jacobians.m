% Calculation of the finger Jacobian matrices.

function [ J1, J2, J3 ] = Finger_Jacobians( o1 , o2 , o3 )

% Parameters
l0 = 22;
l1 = 57;
l2 = 38;
l3 = 22;

% Finger angles
o11 = o1(1);
o12 = o1(2);
o13 = o1(3);
o14 = o1(4);
o21 = o2(1);
o22 = o2(2);
o23 = o2(3);
o24 = o2(4);
o31 = o3(1);
o32 = o3(2);
o33 = o3(3);
o34 = o3(4);

% Sine and cosine conventions for summation
s4_1 = sin(o14);
c4_1 = cos(o14);
s4_2 = sin(o24);
s4_3 = sin(o34);
c4_2 = cos(o24);
c4_3 = cos(o34);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
s123_1 = sin(o11+o12+o13);
s123_2 = sin(o21+o22+o23);
s123_3 = sin(o31+o32+o33);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
c123_1 = cos(o11+o12+o13);
c123_2 = cos(o21+o22+o23);
c123_3 = cos(o31+o32+o33);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
l_s1 = l2*sin(o11+o12)+l3*s123_1;
l_s2 = l2*sin(o21+o22)+l3*s123_2;
l_s3 = l2*sin(o31+o32)+l3*s123_3;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
ls1 = l1*sin(o11)+l2*sin(o11+o12)+l3*s123_1;
ls2 = l1*sin(o21)+l2*sin(o21+o22)+l3*s123_2;
ls3 = l1*sin(o31)+l2*sin(o31+o32)+l3*s123_3;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
l_c1 = l2*cos(o11+o12)+l3*c123_1;
l_c2 = l2*cos(o21+o22)+l3*c123_2;
l_c3 = l2*cos(o31+o32)+l3*c123_3;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
lc1 = l1*cos(o11)+l2*cos(o11+o12)+l3*c123_1;
lc2 = l1*cos(o21)+l2*cos(o21+o22)+l3*c123_2;
lc3 = l1*cos(o31)+l2*cos(o31+o32)+l3*c123_3;

% Linear and angular parts of the geometric Jacobian of the fingers
JP1 = [ -ls1*s4_1   -l_s1*s4_1   -l3*s123_1*s4_1   (lc1 + l0)*c4_1  ;...
            lc1         l_c1         l3*c123_1            0         ;...
        -ls1*c4_1   -l_s1*c4_1   -l3*s123_1*c4_1  -(lc1 + l0)*s4_1  ];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
JO1 = [ -c4_1  -c4_1  -c4_1   0  ;...
          0      0      0     1  ;...
         s4_1   s4_1   s4_1   0   ];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
JP2 = [ -ls2*s4_2   -l_s2*s4_2   -l3*s123_2*s4_2   (lc2 + l0)*c4_2  ;...
          -lc2        -l_c2        -l3*c123_2             0         ;...
        -ls2*c4_2   -l_s2*c4_2   -l3*s123_2*c4_2  -(lc2 + l0)*s4_2  ];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
JO2 = [  c4_2   c4_2   c4_2   0  ;...
           0     0      0     1  ;...
        -s4_2  -s4_2  -s4_2   0  ];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
JP3 = [  ls3*s4_3    l_s3*s4_3    l3*s123_3*s4_3  (lc3 + l0)*c4_3  ;...
          -lc3        -l_c3        -l3*c123_3             0         ;...
        -ls3*c4_3   -l_s3*c4_3   -l3*s123_3*c4_3  -(lc3 + l0)*s4_3  ];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
JO3 = [  c4_3   c4_3   c4_3   0  ;...
           0     0      0     1  ;...
         s4_3   s4_3   s4_3   0  ];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Geometric jacobian matrices
J1 = [ JP1 ; JO1 ];
J2 = [ JP2 ; JO2 ];
J3 = [ JP3 ; JO3 ];

end